USE kpi_softprod;
GO

-- Limpiar datos previos
DELETE FROM dbo.tickets;
DELETE FROM dbo.deployments;
DELETE FROM dbo.batches;

-- Insertar deployments
INSERT INTO dbo.deployments(version, deployed_at) VALUES
(N'1.0.0', '2025-08-18T10:00:00'),
(N'1.1.0', '2025-08-25T11:30:00'),
(N'1.2.0', '2025-09-01T12:00:00'),
(N'1.2.1', '2025-09-04T09:15:00'),
(N'1.3.0', '2025-09-08T18:45:00'),
(N'1.4.0', '2025-09-15T10:30:00'),
(N'1.4.1', '2025-09-22T14:00:00'),
(N'1.5.0', '2025-09-29T09:45:00');

-- Insertar tickets con batch_number (30 ítems por lote)
-- LOTE 1: Primeros 30 ítems
INSERT INTO dbo.tickets(key_code,[type],[status],started_at,completed_at,deployed_at,in_production,batch_number) VALUES
(N'PROJ-001',N'story',N'done','2025-08-01','2025-08-06','2025-08-18',1,1),
(N'PROJ-002',N'story',N'done','2025-08-02','2025-08-08','2025-08-18',1,1),
(N'PROJ-003',N'task', N'done','2025-08-03','2025-08-10','2025-08-18',1,1),
(N'PROJ-004',N'bug',  N'done','2025-08-04','2025-08-12','2025-08-25',1,1),
(N'PROJ-005',N'story',N'done','2025-08-05','2025-08-14','2025-08-25',1,1),
(N'PROJ-006',N'story',N'done','2025-08-06','2025-08-15','2025-08-25',1,1),
(N'PROJ-007',N'bug',  N'done','2025-08-07','2025-08-18','2025-08-25',1,1),
(N'PROJ-008',N'task', N'done','2025-08-08','2025-08-20','2025-09-01',0,1),
(N'PROJ-009',N'story',N'done','2025-08-09','2025-08-22','2025-09-01',1,1),
(N'PROJ-010',N'bug',  N'done','2025-08-10','2025-08-24','2025-09-01',1,1),
(N'PROJ-011',N'story',N'done','2025-08-11','2025-08-26','2025-09-04',1,1),
(N'PROJ-012',N'task', N'done','2025-08-12','2025-08-28','2025-09-04',1,1),
(N'PROJ-013',N'story',N'done','2025-08-13','2025-08-30','2025-09-04',1,1),
(N'PROJ-014',N'bug',  N'done','2025-08-14','2025-09-01','2025-09-08',1,1),
(N'PROJ-015',N'story',N'done','2025-08-15','2025-09-02','2025-09-08',1,1),
(N'PROJ-016',N'task', N'done','2025-08-16','2025-09-03','2025-09-08',1,1),
(N'PROJ-017',N'story',N'done','2025-08-17','2025-09-04','2025-09-08',0,1),
(N'PROJ-018',N'bug',  N'done','2025-08-18','2025-09-05','2025-09-15',1,1),
(N'PROJ-019',N'story',N'done','2025-08-19','2025-09-06','2025-09-15',1,1),
(N'PROJ-020',N'task', N'done','2025-08-20','2025-09-07','2025-09-15',1,1),
(N'PROJ-021',N'story',N'done','2025-08-21','2025-09-08','2025-09-15',1,1),
(N'PROJ-022',N'bug',  N'done','2025-08-22','2025-09-09','2025-09-22',1,1),
(N'PROJ-023',N'task', N'done','2025-08-23','2025-09-10','2025-09-22',1,1),
(N'PROJ-024',N'story',N'done','2025-08-24','2025-09-11','2025-09-22',1,1),
(N'PROJ-025',N'bug',  N'done','2025-08-25','2025-09-12','2025-09-22',0,1),
(N'PROJ-026',N'story',N'done','2025-08-26','2025-09-13','2025-09-29',1,1),
(N'PROJ-027',N'task', N'done','2025-08-27','2025-09-14','2025-09-29',1,1),
(N'PROJ-028',N'story',N'done','2025-08-28','2025-09-15','2025-09-29',1,1),
(N'PROJ-029',N'bug',  N'done','2025-08-29','2025-09-16','2025-09-29',1,1),
(N'PROJ-030',N'story',N'done','2025-08-30','2025-09-17','2025-09-29',1,1);

-- LOTE 2: Ítems 31-60
INSERT INTO dbo.tickets(key_code,[type],[status],started_at,completed_at,deployed_at,in_production,batch_number) VALUES
(N'PROJ-031',N'story',N'done','2025-09-01','2025-09-06','2025-09-08',1,2),
(N'PROJ-032',N'bug',  N'done','2025-09-02','2025-09-07','2025-09-08',1,2),
(N'PROJ-033',N'task', N'done','2025-09-03','2025-09-08','2025-09-08',1,2),
(N'PROJ-034',N'story',N'done','2025-09-04','2025-09-10','2025-09-15',1,2),
(N'PROJ-035',N'bug',  N'done','2025-09-05','2025-09-11','2025-09-15',1,2),
(N'PROJ-036',N'task', N'done','2025-09-06','2025-09-12','2025-09-15',0,2),
(N'PROJ-037',N'story',N'done','2025-09-07','2025-09-13','2025-09-15',1,2),
(N'PROJ-038',N'bug',  N'done','2025-09-08','2025-09-14','2025-09-22',1,2),
(N'PROJ-039',N'story',N'done','2025-09-09','2025-09-15','2025-09-22',1,2),
(N'PROJ-040',N'task', N'done','2025-09-10','2025-09-16','2025-09-22',1,2),
(N'PROJ-041',N'story',N'done','2025-09-11','2025-09-17','2025-09-22',1,2),
(N'PROJ-042',N'bug',  N'done','2025-09-12','2025-09-18','2025-09-29',1,2),
(N'PROJ-043',N'task', N'done','2025-09-13','2025-09-19','2025-09-29',1,2),
(N'PROJ-044',N'story',N'done','2025-09-14','2025-09-20','2025-09-29',1,2),
(N'PROJ-045',N'bug',  N'done','2025-09-15','2025-09-21','2025-09-29',0,2),
(N'PROJ-046',N'story',N'done','2025-09-16','2025-09-22','2025-09-29',1,2),
(N'PROJ-047',N'task', N'done','2025-09-17','2025-09-23','2025-09-29',1,2),
(N'PROJ-048',N'story',N'done','2025-09-18','2025-09-24','2025-09-29',1,2),
(N'PROJ-049',N'bug',  N'done','2025-09-19','2025-09-25','2025-09-29',1,2),
(N'PROJ-050',N'story',N'done','2025-09-20','2025-09-26','2025-09-29',1,2),
(N'PROJ-051',N'task', N'done','2025-09-21','2025-09-27','2025-09-29',1,2),
(N'PROJ-052',N'story',N'done','2025-09-22','2025-09-28','2025-09-29',1,2),
(N'PROJ-053',N'bug',  N'done','2025-09-23','2025-09-29','2025-09-29',1,2),
(N'PROJ-054',N'task', N'done','2025-09-24','2025-09-30','2025-10-06',0,2),
(N'PROJ-055',N'story',N'done','2025-09-25','2025-10-01','2025-10-06',1,2),
(N'PROJ-056',N'bug',  N'done','2025-09-26','2025-10-02','2025-10-06',1,2),
(N'PROJ-057',N'story',N'done','2025-09-27','2025-10-03','2025-10-06',1,2),
(N'PROJ-058',N'task', N'done','2025-09-28','2025-10-04','2025-10-06',1,2),
(N'PROJ-059',N'story',N'done','2025-09-29','2025-10-05','2025-10-06',1,2),
(N'PROJ-060',N'bug',  N'done','2025-09-30','2025-10-06','2025-10-06',1,2);

-- Registrar batches cerrados
INSERT INTO dbo.batches(batch_number, item_count, total_delivered, total_bugs_escaped) VALUES
(1, 30, 30, 2),  -- Lote 1: 2 bugs escapados (PROJ-004, PROJ-014, PROJ-018, PROJ-022 = 4, pero solo 2 en producción)
(2, 30, 30, 3);  -- Lote 2: 3 bugs escapados
